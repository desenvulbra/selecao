var app=angular.module("ulbra",["ngAnimate","ngMessages","ui.router","toastr","ui.utils.masks"]).config(["$stateProvider","$urlRouterProvider","$httpProvider",function(t,r,o){r.otherwise("/"),o.interceptors.push("AuthInterceptor"),t.state("home",{url:"",templateUrl:"/views/home.html",controller:"HomeCtrl",controllerAs:"$ctrl"}).state("cursos",{url:"/cursos",templateUrl:"/views/cursos.html",controller:"CursosCtrl",controllerAs:"$ctrl"})}]);app.controller("CursosCtrl",["Curso","toastr",function(t,r){var o=this;o.cursos=[],t.obterCursos().then(function(t){o.cursos=t.data}).catch(function(){r.error("Falha ao carregar os cursos.")})}]),app.controller("HomeCtrl",["Auth","TokenManager","toastr","$state",function(t,r,o,e){var n=this;n.submitting=!1,n.login=function(){n.submitting=!0,t.authenticate(n.email,n.senha).then(function(t){r.saveToken(t.data.token),o.success("Usu√°rio autenticado com sucesso."),e.go("cursos")}).catch(function(t){n.submitting=!1;var r=t.data.message;o.error(r)})},n.googleSignIn=function(){}}]),app.factory("Auth",["$http",function(t){return{authenticate:function(r,o){return t.post("/auth/login",{email:r,senha:o})}}}]),app.factory("AuthInterceptor",["TokenManager",function(t){return{request:function(r){var o=t.getToken();return o&&(r.headers.Authorization=o),r}}}]),app.factory("Curso",["$http",function(t){return{obterCursos:function(){return t.get("/cursos")}}}]),app.factory("TokenManager",["$window",function(t){return{saveToken:function(r){t.localStorage.jwtToken=r},getToken:function(){return t.localStorage.jwtToken}}}]);